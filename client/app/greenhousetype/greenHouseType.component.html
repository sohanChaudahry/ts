<div class="cointaner">
    <app-loading [condition]="isLoading"></app-loading>

    <app-toast [message]="toast.message"></app-toast>

    <div class="card" *ngIf="!isLoading">
      <h5 class="card-header">Current Gereen HouseTypes ({{greenHouseTypes.length}})</h5>
      
      <div class="card-block" >
        <div class="table-responsive custom_table">
        <table class="table table-bordered">
          <thead class="thead-default">
            <tr>
              <th width="35%">Type</th>
              <th width="35%">Days</th>
              <!--<th width="25%">Start Date</th>-->
              <th width="30%">Action</th>
            </tr>
          </thead>
          <tbody *ngIf="greenHouseTypes.length === 0">
            <tr>
              <td colspan="4">There are no greenHouseType in the DB. Add a new greenHouseType below.</td>
            </tr>  
          </tbody>
          <tbody>
            <tr *ngFor="let greenHouseType of greenHouseTypes">
              <td>
                  <span>{{greenHouseType.type}}</span>
              </td>
              <td>
                  <span>{{greenHouseType.days}}</span>
              </td>
              <!--<td>
                 <span>{{greenHouseType.start_date| date}}</span>
              </td>-->
              <td>
                  <button class="btn btn-sm btn-warning" *ngIf="greenHouseType.isEditing!=true" (click)="editGreenHouseTypeBtn(greenHouseType);checkIdAvaiable=greenHouseType._id;"><i class="fa fa-pencil"></i>Edit</button> 
                  <button class="btn btn-sm btn-primary" *ngIf="greenHouseType.isEditing==true" (click)="editGreenHouseType(greenHouseType)"><i class="fa fa-floppy-o"></i>Save</button>
                  <button class="btn btn-sm btn-danger" (click)="deleteGreenHouseType(greenHouseType)"><i class="fa fa-trash"></i> Delete</button>
                  <button class="btn btn-sm btn-warning" *ngIf="greenHouseType.isEditing==true" (click)="greenHouseType.isEditing=false;"><i class="fa fa-times"></i>Cancel</button>
                  <button class="btn btn-sm btn-info" (click)="editActivityBtn(greenHouseType);"><i class="fa fa-pencil"></i>Activites</button> 
              </td>
            </tr> 
            <!--for edit activity dialog-->
              <popup>
                  <form (ngSubmit)="addActivities()" ngNativeValidate>
                    <div class="row">
                        <div class="col-md-1"></div>
                        <div class="col-md-5">
                            <div class="form-group">
                              <label for="exampleFormControlTextarea1">Name</label>
                              <input class="form-control" type="text" name="name" placeholder="Name"  [(ngModel)]="activityData.name" required>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="form-group">
                              <label for="exampleFormControlTextarea1">Day</label>
                              <input class="form-control" type="number" name="day" placeholder="Day"  [(ngModel)]="activityData.day" required>
                            </div>
                        </div>
                        <div class="col-md-1"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-1"></div>
                        <div class="col-md-5">
                            <div class="form-group"> 
                                <label for="exampleFormControlTextarea1">Status</label>
                                <select class="form-control" name="status" name="status" placeholder="Status"  [(ngModel)]="activityData.status" required>
                                    <option *ngFor="let st of statusList" [ngValue]="st.status">{{st.status}}</option>
                                </select>
                            </div>
                        </div>
                         <div class="col-md-5">
                            <div class="form-group"> 
                              <label for="exampleFormControlTextarea1">Green house type</label>
                              <select class="form-control" name="greenHouseTypeId"  [(ngModel)]="activityData.greenHouseTypeId" required>
                                <option [ngValue]="type._id" *ngFor="let type of greenHouseTypes">{{type.type}}</option>
                              </select>
                            </div>
                        </div>
                        <div class="col-md-1"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-1"></div>
                        <div class="col-md-10">
                            <div class="form-group">
                              <label for="exampleFormControlTextarea1">Description</label>
                              <textarea class="form-control" id="exampleFormControlTextarea1" rows="2" name="description" placeholder="Description"  [(ngModel)]="activityData.description" required></textarea>
                            </div>
                        </div>
                        <div class="col-md-1"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-1"></div>
                        <div class="col-md-10">
                            <div class="form-group"> 
                               <label for="exampleFormControlTextarea1">Comment</label>
                               <textarea class="form-control" id="exampleFormControlTextarea1" rows="2" name="comment" placeholder="Comment"  [(ngModel)]="activityData.comment" required></textarea>
                            </div>
                        </div>
                        <div class="col-md-1"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-1"></div>
                        <div class="col-md-6">
                          <button class="btn btn-sm btn-primary" type="submit"><i class="fa fa-floppy-o"></i> Save</button>
                          <button class="btn btn-sm btn-warning" (click)="cancelDialog();"><i class="fa fa-times"></i> Cancel</button>
                        </div>
                    </div>
                 </form>
              </popup> 
          </tbody>  
        </table>
        </div>
      </div>
    </div>
    <div class="card" *ngIf="!isEditing && !isEditActivity" style="background: #eee;">
      <h5 class="card-header">Add green house type</h5>
        <form [formGroup]="addGreenHouseTypeForm" (ngSubmit)="checkIdAvaiable ? updateGreenHouseType() : addGreenHouseType()">
          <br>
          <div class="row">
              <div class="col-md-1"></div>
              <div class="col-md-10">
                 <div class="form-group">
                   <label for="exampleFormControlTextarea1">Type</label>
                   <input class="form-control" type="text" name="type" formControlName="type" placeholder="Type">
                  </div>
              </div>
              <div class="col-md-1"></div>
          </div>
          <div class="row">
              <div class="col-md-1"></div>
              <div class="col-md-10">
                <div class="form-group">
                   <label for="exampleFormControlTextarea1">Days</label>
                   <input class="form-control" type="number" name="age" formControlName="days" placeholder="Days" min="1">
                </div>
              </div>
              <div class="col-md-1"></div>
           </div>
           <!--<div class="row">
              <div class="col-md-1"></div>
              <div class="col-md-10">
                <div class="form-group">
                  <label for="exampleFormControlTextarea1">Start Date</label>
                  <input class="form-control" type="date" name="startdate" formControlName="start_date" placeholder="Start Date">
                </div>
              </div>
              <div class="col-md-1"></div>
          </div>-->
          <div class="row">
              <div class="col-md-1"></div>
              <div class="col-md-6">
                <button class="btn btn-primary" type="submit" [disabled]="!addGreenHouseTypeForm.valid"><i class="fa fa-floppy-o"></i> Save</button>
                <button class="btn btn-primary" type="button" (click)="removeEditData()"><i class="fa fa-floppy-o"></i> Cancel</button>
              </div>
          </div>
          <br>
        </form>
     </div>
     <div class="card" *ngIf="isEditActivity">
        <h5 class="card-header">Add Activities</h5>
        <div class="card-block">
            <div class="col-md-12 activity_table_hearder">
              <span class="col-md-6">Green house type : {{selectedActivityData.type}}</span>
              <span class="col-md-6">Days : {{selectedActivityData.days}}</span>
              <!--<span class="col-md-4">Date : {{selectedActivityData.start_date| date}}</span>-->
            </div>
            <div class="table-responsive custom_table" style="max-height:400px;">
                <table class="table table-bordered">
                    <thead class="thead-default">
                        <tr>
                          <th width="7%">Day</th>
                          <th width="28%">Name</th>
                          <th width="65%">Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let act of activityData">
                          <td>
                              <select class="form-control" type="number" [(ngModel)]="act.day">
                                <option *ngFor="let DAYEND of swapEndDays;let i = index" [ngValue]="i+1" placeholder="Day">{{i+1}}</option>
                              </select>
                          </td>
                          <td>
                              <div class="form-group">
                                <input class="form-control" type="text" [(ngModel)]="act.name" placeholder="Name">
                              </div>
                          </td>
                          <td>
                              <div class="form-group">
                                <input class="form-control" type="text" [(ngModel)]="act.description" placeholder="Description">
                              </div>
                          </td>
                        </tr> 
                    </tbody>  
                </table>
            </div>
            <div class="row">
                <div class="col-md-8"></div>
                <div class="col-md-3">
                  <button class="btn btn-sm btn-info" (click)="addActivityEditRow()"><i class="fa fa-plus" aria-hidden="true"></i>Add Row</button> 
                  <button class="btn btn-sm btn-warning" (click)="cancelEditActivity()"><i class="fa fa-pencil"></i>Cancel</button> 
                  <button class="btn btn-sm btn-primary" (click)="addActivities()"><i class="fa fa-floppy-o"></i>Save</button> 
                </div>
                <div class="col-md-1"></div>
            </div>
        </div>
    </div>
</div>
